<!DOCTYPE html>
<HTML lang="en">
	<HEAD>
		<META CHARSET="UTF-8">
		<META name="viewport" content="width=device-width, initial-scale=1.0">
		<META charset="UTF-8">
		<LINK href="MyMenu002.css" rel="stylesheet">
		<META name="viewport" content="width=device-width, initial-scale=1.0">
		<TITLE>User access count</TITLE>
		<!--
		<LINK rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		-->
	</HEAD>
	<BODY TOPMARGIN='0' LEFTMARGIN='0' MARGINHEIGHT='0' MARGINWIDTH='0'>
		<DIV style="width:100%;display:block;margin:0;padding:0;">
			<TABLE style="width:100%; margin:0; padding:0;">
					<TR>
						<TD style="text-align:center;vertical-align:top;background-color:#0071bb;" colspan='9'>
							<FONT size='5'><FONT color='white'>Human-AI Financial Solutions = HAI FS</FONT></FONT>
						</TD>
					</TR>
			<SCRIPT type='text/javascript'>
				if( window.location.href.includes('index.html') )
				{
					document.write("<TR><TD><A><Font color='orange'>Home</FONT></A></TD>");
				}
				else
				{
					document.write("<TR><TD><A href='index.html' class='link-style' href='/ExplorerPatcher-Exception-Windows-11-Home-Single-Language/spending.html' id='PreventWastagehref' style='color:blue'>Home</A></TD>");
				}
				function showHomeTable()
				{
					const tamilhomeTable = document.getElementById('TamilHomeTable');
					const englishhomeTable = document.getElementById('EnglishHomeTable');
					const preventWastage = document.getElementById('PreventWastage');
					const categoryAmount = document.getElementById('CategoryAmountDetailsTab');
					preventWastage.style.display = 'none';
					categoryAmount.style.display = 'none';
					tamilhomeTable.style.display = 'table';
					englishhomeTable.style.display = 'table';
				}
			</SCRIPT>
						<TD>
							<A href='spending.html' class='link-style' id='PreventWastagehref' style='color:blue'>PreventWastage</A>
						</TD>
						<TD>
						<A href="save_money_and_lives.html">Save lives and money</A>
						</TD>
						<TD>
						<A href="ShareKnowledgeTransferToPeople.html"><U>ShareKnowledgeTransferToPeople</U></A>
						</TD>
						<TD>
						<A href="https://www.geocities.ws/murugesan/mis-interest.html">FinanceHelp</A>
						</TD>
						<TD bgcolor='orange' style='valign:top;align:left;'>
						<A>Visitor count</FONT></A>
						</TD>
						<TD>
						<A><FONT color='#556677'>Inprogress02</FONT></A>
						</TD>
						<TD>
						<A><FONT color='#556677'>Inprogress03</FONT></A>
						</TD>
					</TR>
				</TABLE>
		</DIV>
		<TABLE border='1'>
		<THEAD>
		<TR>
		<TH>User Count for https://murugesanopenssl.github.io/ExplorerPatcher-Exception-Windows-11-Home-Single-Language</TH>
		<TH>Country</TH>
		</TR>
		</THEAD>
		<TBODY id="tbody"></TBODY>
		</TABLE>
		<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyDSNanmji7WVBtQHlPO-J_E5RQu9Qlq4Qw",
    authDomain: "openmurugesan.firebaseapp.com",
    databaseURL: "https://openmurugesan-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "openmurugesan",
    storageBucket: "openmurugesan.firebasestorage.app",
    messagingSenderId: "307675598593",
    appId: "1:307675598593:web:4af163460ce2c3bc719500",
    measurementId: "G-0MFK92PQMP"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const tbody = document.getElementById("tbody");

const id = "VISIT-" + Date.now();
const bow = navigator.userAgent;

const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
const ctry = (tz.includes("Kolkata") || tz.includes("Calcutta")) ? "INDIA" : "Location: UNKNOWN – location for these users is not available due to VPN, proxy, or privacy settings on their device.";

set(ref(db, "userAccess/" + id), {
	browser: bow,
	country: ctry,
	timezone: tz,
	timestamp: Date.now()
});

onValue(ref(db, "userAccess"), snap => {
	tbody.innerHTML = "";
	let counts = {};

	snap.forEach(child => {
		let raw = child.val().country;
		let finalC = (raw === "INDIA") ? "INDIA" : "Location: UNKNOWN – location for these users is not available due to VPN, proxy, or privacy settings on their device.";
		counts[finalC] = (counts[finalC] || 0) + 1;
	});

	Object.keys(counts).forEach(country => {
		tbody.innerHTML += `
		<tr>
			<td valign='top' align='right'>${String(counts[country]).padStart(4,"0")}</td>
			<td valign='top' align='right'>${country}</td>
		</tr>`;
	});
});
</script>
	</BODY>
</HTML>